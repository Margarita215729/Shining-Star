<!-- Admin Services Management -->
<div class="admin-header">
    <div class="admin-nav">
        <div class="admin-brand"><a href="/admin" class="logo"><i class="fas fa-star"></i><span>Admin
                    Dashboard</span></a></div>
        <div class="admin-user"><span>Welcome, <%= user.username %></span>
            <form action="/admin/logout" method="POST" style="display:inline;"><button type="submit"
                    class="btn btn-outline btn-sm"><i class="fas fa-sign-out-alt"></i>
                    <%= __('admin.logout') %>
                </button></form>
        </div>
    </div>
</div>
<div class="admin-layout">
    <aside class="admin-sidebar">
        <nav class="admin-menu">
            <ul>
                <li><a href="/admin" class="<%= (currentPage||'').includes('admin-dashboard') ? 'active' : '' %>"><i
                            class="fas fa-tachometer-alt"></i>
                        <%= __('admin.dashboard') %>
                    </a></li>
                <li><a href="/admin/portfolio"
                        class="<%= (currentPage||'').includes('admin-portfolio') ? 'active' : '' %>"><i
                            class="fas fa-images"></i>
                        <%= __('admin.manage_portfolio') %>
                    </a></li>
                <li><a href="/admin/services"
                        class="<%= (currentPage||'').includes('admin-services') ? 'active' : '' %>"><i
                            class="fas fa-broom"></i>
                        <%= __('admin.manage_services') %>
                    </a></li>
                <li><a href="/admin/packages"
                        class="<%= (currentPage||'').includes('admin-packages') ? 'active' : '' %>"><i
                            class="fas fa-box"></i>
                        <%= __('admin.manage_packages') %>
                    </a></li>
            </ul>
        </nav>
    </aside>
    <main class="admin-content">
        <div class="admin-page-header">
            <h1>
                <%= __('admin.manage_services') %>
            </h1>
            <div>
                <button id="btn-add-service" class="btn btn-primary"><i class="fas fa-plus"></i> Add Service</button>
            </div>
        </div>
        <div class="admin-card">
            <table class="admin-table" id="services-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Duration</th>
                        <th>Type</th>
                        <th>Available</th>
                        <th style="width:160px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <% (services||[]).forEach(s=> { %>
                        <tr data-id="<%= s.id %>">
                            <td><strong>
                                    <%= s.name[locale] || s.name.en %>
                                </strong><br><small><code><%= s.id %></code></small></td>
                            <td>$<%= s.price %>
                            </td>
                            <td>
                                <%= s.duration %> min
                            </td>
                            <td>
                                <%= s.calculationType || 'fixed' %>
                            </td>
                            <td><span class="badge <%= s.available ? 'badge-success' : 'badge-muted' %>">
                                    <%= s.available ? 'Yes' : 'No' %>
                                </span></td>
                            <td>
                                <button class="btn btn-sm btn-outline" data-action="edit" data-id="<%= s.id %>"><i
                                        class="fas fa-edit"></i> Edit</button>
                                <button class="btn btn-sm btn-danger" data-action="delete" data-id="<%= s.id %>"><i
                                        class="fas fa-trash"></i> Delete</button>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
        </div>

        <!-- Service Modal -->
        <div id="service-modal" class="modal" style="display:none;">
            <div class="modal-content" style="max-width:820px;">
                <div class="modal-header">
                    <h3 id="service-modal-title">Add Service</h3>
                    <button class="modal-close" id="service-modal-close">Ã—</button>
                </div>
                <div class="modal-body">
                    <form id="service-form">
                        <input type="hidden" id="service-id" />
                        <div class="grid grid-2">
                            <div>
                                <label>Name (EN)</label>
                                <input type="text" id="service-name-en" required />
                            </div>
                            <div>
                                <label>Name (RU)</label>
                                <input type="text" id="service-name-ru" />
                            </div>
                            <div>
                                <label>Name (ES)</label>
                                <input type="text" id="service-name-es" />
                            </div>
                            <div>
                                <label>Category</label>
                                <input type="text" id="service-category"
                                    placeholder="general / kitchen / bathroom ..." />
                            </div>
                        </div>

                        <div class="grid grid-3">
                            <div>
                                <label>Price (USD)</label>
                                <input type="number" step="0.01" id="service-price" required />
                            </div>
                            <div>
                                <label>Duration (min)</label>
                                <input type="number" id="service-duration" required />
                            </div>
                            <div>
                                <label>Available</label>
                                <select id="service-available">
                                    <option value="true">Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-3">
                            <div>
                                <label>Calculation Type</label>
                                <select id="service-calculationType">
                                    <option value="fixed">Fixed</option>
                                    <option value="quantity">Quantity</option>
                                    <option value="area">Area</option>
                                    <option value="time">Time</option>
                                </select>
                            </div>
                            <div>
                                <label>Unit</label>
                                <input type="text" id="service-unit" placeholder="e.g. piece, window, sqft" />
                            </div>
                            <div>
                                <label>Max Quantity</label>
                                <input type="number" id="service-maxQuantity" />
                            </div>
                        </div>
                        <div class="grid grid-2">
                            <div>
                                <label>Min Area (sqft)</label>
                                <input type="number" id="service-minArea" />
                            </div>
                            <div>
                                <label>Max Area (sqft)</label>
                                <input type="number" id="service-maxArea" />
                            </div>
                        </div>

                        <div class="grid">
                            <div>
                                <label>Description (EN)</label>
                                <textarea id="service-description-en" rows="3" required></textarea>
                            </div>
                            <div>
                                <label>Description (RU)</label>
                                <textarea id="service-description-ru" rows="3"></textarea>
                            </div>
                            <div>
                                <label>Description (ES)</label>
                                <textarea id="service-description-es" rows="3"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="service-cancel">Cancel</button>
                    <button class="btn btn-primary" id="service-save">Save</button>
                </div>
            </div>
        </div>

        <script id="services-data" type="application/json"><%- JSON.stringify(services || []) %></script>
    </main>
</div>